# Transition

The Transition component lets you add enter/leave transitions to conditionally rendered elements, using CSS classes to control the actual transition styles in the different stages of the transition.

import { useState, cloneElement } from "react";
import { WithTransition } from "@atomic_ui_react/transition/mod.ts";
import { useBoolean } from "@atomic_ui_react/hooks/mod.ts";
import Playground from "~/components/playground.tsx";

export const buttonClassName = `px-3 mb-4 py-2 font-medium text-white bg-red-500 border border-red-600 transition transform rounded-full active:bg-opacity-40 hover:scale-105 hover:bg-opacity-30 focus:outline-none focus:ring bg-opacity-20`;
export const boxClassName = `w-32 h-32 bg-white border border-red-500 rounded-md shadow-lg`;

export const transitionProps = {
  enter: "transform transition duration-400",
  enterFrom: "opacity-0 rotate-120 scale-50",
  enterTo: "opacity-100 rotate-0 scale-100",
  leave: "transform duration-200 transition ease-in-out",
  leaveFrom: "opacity-100 rotate-0 scale-100",
  leaveTo: "opacity-0 scale-95",
};

export const BasicExample = () => {
  const [isShow, { toggle }] = useBoolean(true);
  return (
    <>
      <button onClick={toggle} className={buttonClassName}>
        Toggle
      </button>
      <WithTransition immediate isShow={isShow} {...transitionProps}>
        <div className={boxClassName} />
      </WithTransition>
    </>
  );
};

export const Box = () => (
  <div className="w-32 h-32 bg-white rounded-md shadow-lg" />
);

<Playground preview={<BasicExample />}>
```tsx
export default = () => {
  const [isShow, { toggle }] = useBoolean(true);
  return (
    <>
      <button onClick={toggle}>Toggle</button>
      <WithTransition
        isShow={isShow}
        {...transitionProps}
      >
       <div className="w-32 h-32 bg-white rounded-md shadow-lg" />
      </WithTransition>{" "}
    </>
  );
};
```
</Playground>

Once the transition was over, the element was removed from the DOM and a Layout Shift occurred.

Let's learn more about Transition through the resolution of this strange behavior.

## Conrtoll rendering

`render` props can specify the actual elements to be rendered.

By default, the `render` function works to remove the element from the DOM when the transition is completed and `isShow` props is `false`.
This internally calls the next function.

```ts
import { ReactElement, cloneElement, createElement, Fragment } from "react";
import { TransitionRender } from "https://deno.land/x/atomic_ui_react@$VERSION/mod.ts";
const defaultRender: TransitionRender<any> = ({
  isShowable,
  children,
  mergedProps,
}): ReactElement => {
  return isShowable
    ? cloneElement(children, mergedProps)
    : createElement(Fragment);
};
```

First argment - `Context`

| name        | type           | description                                                           |
| ----------- | -------------- | --------------------------------------------------------------------- |
| children    | `ReactElement` | Root child adapting transitions.                                      |
| mergedProps | `mergedProps`  | Props that deep merged with children root props and transition props. |
| isShowable  | `boolean`      | Whether transition is completed and `isShow` state is `false` or not. |

Let's look at an example that gives you complete control over this behavior.

export const RenderExample = () => {
  const [isShow, { toggle }] = useBoolean(true);
  return (
    <>
      <button className={buttonClassName} onClick={toggle}>
        Toggle
      </button>
      <WithTransition
        {...transitionProps}
        leaveTo="opacity-20 border-6 border-dashed opacity-20 scale-95 transform"
        leaved="opacity-20 border-6 border-dashed opacity-20 scale-95 transform"
        isShow={isShow}
        render={({ children, ref }) => {
          return cloneElement(children, { ref });
        }}
      >
        <div className={boxClassName} />
      </WithTransition>
    </>
  );
};

<Playground preview={<RenderExample />}>

```tsx
import {
  Transition,
  useBoolean,
} from "https://deno.land/x/atomic_ui_react@$VERSION/mod.ts";

export default () => {
  const [isShow, { toggle }] = useBoolean(true);
  return (
    <>
      <button onClick={toggle}>Toggle</button>
      <WithTransition
        enter="transform transition duration-400"
        enterFrom="opacity-0 rotate-120 scale-50"
        enterTo="opacity-100 rotate-0 scale-100"
        leave="transform duration-200 transition ease-in-out"
        leaveFrom="opacity-100 rotate-0 scale-100"
        leaveTo="opacity-0 scale-95"
        leaved="border"
        isShow={isShow}
      >
        <div />
      </WithTransition>
    </>
  );
};
```

</Playground>

Instead of removing it from the DOM, change the `visibility` of the CSS Property. This prevents LayoutShift from occurring.

## API

### WithTransition

#### Props

Generics: `<E extends Element = Element>`

| Name      | Type            | Required / Default | Description                                                                                                                                              |
| --------- | --------------- | :----------------: | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| children  | `ReactElement`  | :white_check_mark: | Root child adapting transitions.                                                                                                                         |
| isShow    | `boolean`       |        [^1]        | Whether the target should be shown or hidden.                                                                                                            |
| isRoot    | `boolean`       |   [^1] / `true`    | Whether this component is transition root or not.                                                                                                        |
| immediate | `boolean`       |      `false`       | Whether do transitions immediately(on first mount) or not. <br/> `true` - do transition on first mount.<br/> `false` - do not transition on first mount. |
| enter     | `string`        |         -          | Classes during the entire enter phase.                                                                                                                   |
| enterFrom | `string`        |         -          | Classes immediately after the enter phase starts.                                                                                                        |
| enterTo   | `string`        |         -          | Classes immediately after the enter phase starts.                                                                                                        |
| entered   | `string`        |         -          | Classes the enter phase is ended.                                                                                                                        |
| leave     | `string`        |         -          | Classes during the entire leave phase.                                                                                                                   |
| leaveTo   | `string`        |         -          | Classes before the leave phase starts.                                                                                                                   |
| leaveFrom | `string`        |         -          | Classes to immediately after the leave phase starts.                                                                                                     |
| leaved    | `string`        |         -          | Classes the leave phase is ended.                                                                                                                        |
| render    | `Render<E>`[^2] |         -          | Controls the rendering element. Called just before rendering, it returns the element to actually render.                                                 |
| onChange  | [^3]            |         -          | Call on change transition states.                                                                                                                        |

[^1]: Exclusive property. Must be either `isShow` or `isRoot`.

    ```tsx
    type ExclusiveOption =
      | {
          isShow: boolean;
          isRoot: true;
        }
      | {
          isShow: never;
          isRoot: false;
        };
    ```

[^2]: `Render<E>`

    ```tsx
    import { ReactElement, RefObject } from "react";
    import {
      UseTransitionReturnValue,
      UseGroupTransitionReturnValue,
      TransitionProps,
    } from "https://deno.land/x/atomic_ui_react@$VERSION/mod.ts";

    type RenderParam<E extends Element = Element> = {
      /** Root child adapting transitions. */
      children: ReactElement;

      /** The root child `RefObject` */
      ref: RefObject<E>;
    };

    type RenderContext = UseTransitionReturnValue &
      UseGroupTransitionReturnValue &
      Required<Pick<TransitionProps, "isShow" | "immediate" | "isRoot">>;

    type Render<E extends Element = Element> = (
      param: RenderParam<E>,
      context: RenderContext
    ) => ReactElement;
    ```

[^3]: `function`

    - 1st Arg - state: `UseTransitionReturnValue`
    - Return - `void`
